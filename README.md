# Yomeru

Offline Japanese text scanner and translator. Point your camera at Japanese text and get instant word-by-word translations — entirely on-device after initial setup.

## Features

- **Live camera OCR** — Scan Japanese text from signs, menus, labels, and more
- **Word-by-word dictionary** — Readings (hiragana), English translations, and part-of-speech tags via JMdict
- **Phrase translation** — Full-sentence Japanese-to-English translation powered by Opus-MT
- **Fully offline** — All processing runs in the browser; no server required after model download (~50 MB)
- **PWA** — Installable on mobile; works without a network connection

## How It Works

```
Camera frame
  → Preprocessing (grayscale, contrast normalization, adaptive threshold)
  → OCR (Tesseract.js, Japanese trained data)
  → Segmentation (TinySegmenter)
  → Dictionary lookup (JMdict via IndexedDB)
  → Phrase translation (Opus-MT via Hugging Face Transformers)
  → Results overlay + info panel
```

## Tech Stack

| Layer | Technology |
|-------|-----------|
| UI | React 19, TypeScript 5.9, Vite 7 |
| OCR | Tesseract.js 7 (WASM) |
| Segmentation | TinySegmenter |
| Dictionary | JMdict (~22K common entries, IndexedDB) |
| Translation | Helsinki-NLP Opus-MT (Hugging Face Transformers) |
| Offline | Workbox service worker, vite-plugin-pwa |

## Getting Started

```bash
npm install
npm run dev
```

Open the app on your phone (or localhost) and follow the onboarding to download the OCR and translation models.

### Scripts

| Command | Description |
|---------|-------------|
| `npm run dev` | Start dev server |
| `npm run build` | Production build |
| `npm test` | Run tests |
| `npm run test:watch` | Run tests in watch mode |
| `npm run build:dict` | Rebuild JMdict lookup JSON |
| `npm run generate:fixtures` | Generate synthetic test fixture PNGs |

## Testing

Tests run in jsdom via Vitest:

```bash
npm test
```

The test suite covers preprocessing, OCR filters, segmentation, dictionary translation, and synthetic fixture validation. Synthetic fixtures are PNG images with known Japanese text generated by `npm run generate:fixtures`, enabling pipeline validation without a real camera or device.

## Project Structure

```
src/
  components/    Camera, TextOverlay, InfoPanel, ModelManager, Onboarding
  services/
    preprocessing.ts    Image binarization for OCR
    ocr/                Tesseract wrapper and result filters
    translation/        Segmenter + dictionary + Opus-MT models
    storage/            IndexedDB dictionary persistence
  hooks/           useCamera, usePipeline
  types/           TypeScript type definitions
tests/
  pipeline.test.ts             Core pipeline tests
  synthetic-fixtures.test.ts   Synthetic fixture tests
  fixtures/                    Test fixture metadata (PNGs gitignored)
scripts/
  build-dictionary.ts          JMdict JSON builder
  generate-synthetic-fixtures.ts  Synthetic test image generator
public/
  dict/jmdict-lookup.json      Prebuilt dictionary
```

## License

Private.
